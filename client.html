<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Yureco Augment – тест клієнта</title>
  <style>
    :root { --bg:#0b1220; --card:#111a2b; --text:#eaf1ff; --muted:#9fb2d9; }
    html,body { background:var(--bg); color:var(--text); font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:0; }
    .wrap { max-width:840px; margin:32px auto; padding:0 16px; }
    .card { background:var(--card); border-radius:14px; padding:18px; box-shadow:0 6px 30px rgba(0,0,0,.25); }
    h1 { font-size:22px; margin:0 0 10px; }
    label { font-weight:600; display:block; margin:14px 0 6px; color:var(--muted); }
    textarea, input { width:100%; background:#0d1526; color:var(--text); border:1px solid #223358; border-radius:10px; padding:12px; }
    textarea { min-height:110px; resize:vertical; }
    .row { display:flex; gap:12px; flex-wrap:wrap; }
    button { background:#2563eb; border:0; color:#fff; padding:12px 16px; border-radius:10px; cursor:pointer; font-weight:700; }
    button[disabled] { opacity:.6; cursor:not-allowed; }
    .out { white-space:pre-wrap; background:#0d1526; border:1px solid #223358; border-radius:10px; padding:12px; margin-top:12px; }
    .badge { display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; margin-left:8px; }
    .yes { background:#16a34a33; color:#34d399; border:1px solid #16a34a; }
    .no  { background:#ef444433; color:#fca5a5; border:1px solid #ef4444; }
    .hint { color:var(--muted); font-size:13px; margin-top:8px; }
    .small { font-size:12px; color:var(--muted); }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Yureco Augment – тест клієнта <span id="badge" class="badge no">injected: false</span></h1>

      <label>Адреса API</label>
      <input id="api" value="http://127.0.0.1:8000/chat" />

      <label>Запит користувача</label>
      <textarea id="query" placeholder="Напр.: Потрібна утилізація батарейок у Києві"></textarea>

      <label>Базова відповідь (від твоєї LLM або заглушка)</label>
      <textarea id="base">Дякую за запит. Ось загальна інформація…</textarea>

      <div class="row" style="margin-top:12px">
        <button id="send">Надіслати</button>
        <span id="status" class="small"></span>
      </div>

      <label>Відповідь</label>
      <div id="out" class="out">—</div>

      <div class="hint">Порада: якщо в запиті є слова з нашого списку (утилізація, відходи, батарейки, лампи тощо) і НІ слів із «без реклами», в кінці відповіді з’явиться блок із Юреко.</div>
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const btn = $("send"), out = $("out"), badge = $("badge"), status = $("status");

    function setBadge(injected){
      badge.textContent = "injected: " + injected;
      badge.className = "badge " + (injected ? "yes" : "no");
    }

    async function callApi(){
      const url = $("api").value.trim();
      const body = {
        query: $("query").value.trim(),
        base_answer: $("base").value.trim()
      };

      btn.disabled = true;
      status.textContent = "Виконується запит…";
      setBadge(false);
      out.textContent = "—";

      try {
        const r = await fetch(url, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body)
        });
        const data = await r.json();
        setBadge(!!data.injected);
        out.textContent = data.final_answer || "(порожньо)";
        status.textContent = "Готово";
      } catch (e) {
        status.textContent = "Помилка";
        out.textContent = "Помилка запиту: " + e.message;
      } finally {
        btn.disabled = false;
      }
    }

    btn.addEventListener("click", callApi);
  </script>
</body>
</html>
